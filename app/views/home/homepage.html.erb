<% content_for :title, "#{t('app.brand')} - #{t('app.meta.title')}" %>

<!-- Filters Section -->
<section class="filters-section" style="height: 100vh; background: url('<%= asset_path('macedonia.png') %>') no-repeat center center; background-size: cover;">
  <div class="container mb-2">
    <div class="mobile-top-bar">
      <!-- Mobile Language Switcher (hidden on desktop) -->
      <div class="mobile-quick-call">
        <span class="mobile-call-text"><%#= t('cars.index.call_to_book') %></span>
        <a href="tel:+38971297645" class="quick-call-link" aria-label="<%= t('contact.info.phone.title') %>">ğŸ“</a>
      </div>
      <div class="mobile-language-switcher">
        <% I18n.available_locales.each do |loc| %>
          <% if loc == I18n.locale %>
            <span class="lang current"><%= t("app.language.#{loc}") %></span>
          <% else %>
            <%= link_to t("app.language.#{loc}"), url_for(params.permit!.to_h.merge(locale: loc)), class: 'lang' %>
          <% end %>
        <% end %>
      </div>
    </div>

    <div class="filters-header">
      <h1 class="filters-title"><%= t('cars.index.find_perfect') %></h1>
      <p class="filters-subtitle"><%= t('cars.index.subtitle1') %></p>
      <p class="filters-subtitle"><%#= t('cars.index.subtitle2') %></p>
    </div>

    <%= form_with url: cars_path, method: :get, class: "filters-form", html: { data: { controller: "filters" } } do |form| %>
      <div class="filters-container">
        <!-- Date Availability Filters -->
        <div class="date-availability-section">
          <h4 class="filter-section-title"><%= t('cars.index.check_availability') %></h4>
          <div class="date-filters">
            <div class="filter-group">
              <label class="filter-label"><%= t('cars.index.pickup_date') %></label>
              <%= form.date_field :start_date, 
                  value: params[:start_date], 
                  min: Date.current,
                  class: "filter-input" %>
            </div>
            
            <div class="filter-group">
              <label class="filter-label"><%= t('cars.index.dropoff_date') %></label>
              <%= form.date_field :end_date, 
                  value: params[:end_date], 
                  min: Date.current + 1.day,
                  class: "filter-input" %>
            </div>
          </div>
        </div>

        <!-- Collapsible Other Filters -->
        <div class="other-filters-toggle-wrapper">
          <button type="button" class="btn btn-secondary btn-filter btn-filter-toggle"
                  data-filters-target="button"
                  data-action="filters#toggle"
                  data-label="<%= t('cars.index.more_filters') %>"
                  aria-expanded="false" aria-controls="additional-filters-panel">
            <span data-filters-target="toggleLabel">â• <%= t('cars.index.more_filters') %></span>
          </button>
        </div>

        <div id="additional-filters-panel" class="other-filters-section" data-filters-target="panel" hidden>
          <h4 class="filter-section-title"><%= t('cars.index.more_filters') %></h4>
          <div class="other-filters">
            <div class="filter-group">
              <label class="filter-label"><%= t('cars.index.brand') %></label>
              <%= form.text_field :brand, value: params[:brand], placeholder: t('cars.index.brand_placeholder'), class: "filter-input" %>
            </div>
            <div class="filter-group">
              <label class="filter-label"><%= t('cars.index.year_from') %></label>
              <%= form.number_field :year_from, value: params[:year_from], placeholder: "2020", class: "filter-input" %>
            </div>
            <div class="filter-group">
              <label class="filter-label"><%= t('cars.index.year_to') %></label>
              <%= form.number_field :year_to, value: params[:year_to], placeholder: "2025", class: "filter-input" %>
            </div>
            <div class="filter-group">
              <label class="filter-label"><%= t('cars.index.max_price') %></label>
              <%= form.number_field :max_price, value: params[:max_price], placeholder: "500", step: 0.01, class: "filter-input" %>
            </div>
          </div>
        </div>
        
        <div class="filters-actions">
          <%= form.submit t('cars.index.filter_submit'), class: "btn btn-primary btn-filter" %>
        </div>
      </div>
    <% end %>
  </div>
</section>

<!-- Featured Cars Section -->
<% if @featured_cars&.any? %>
  <section class="featured-cars-section">
    <div class="container">
      <div class="section-title">
        <h2><%= t('home.featured_cars.title', default: 'Ğ˜ÑÑ‚Ğ°ĞºĞ½Ğ°Ñ‚Ğ¸ Ğ²Ğ¾Ğ·Ğ¸Ğ»Ğ°') %></h2>
        <p><%= t('home.featured_cars.desc', default: 'ĞÑ‚ĞºÑ€Ğ¸Ñ˜Ñ‚Ğµ Ğ³Ğ¸ Ğ½Ğ°ÑˆĞ¸Ñ‚Ğµ Ğ½Ğ°Ñ˜Ğ¿Ğ¾Ğ¿ÑƒĞ»Ğ°Ñ€Ğ½Ğ¸ Ğ¸ Ğ·Ğ°Ñ„Ğ°Ñ‚Ğ»Ğ¸Ğ²Ğ¸ Ğ²Ğ¾Ğ·Ğ¸Ğ»Ğ° Ğ´Ğ¾ÑÑ‚Ğ°Ğ¿Ğ½Ğ¸ Ğ·Ğ° Ğ¸Ğ·Ğ½Ğ°Ñ˜Ğ¼ÑƒĞ²Ğ°ÑšĞµ.') %></p>
      </div>
      
      <div class="cars-preview-grid">
        <% @featured_cars.each do |car| %>
          <div class="car-card" data-cars-target="card">
            <%= link_to car_path(car), class: "car-card-link", data: { turbo_frame: "_top" } do %>
              <div class="car-image-wrapper">
                <img src="<%= car.image_url %>" alt="Rent a car Skopje - Autorentals.mk - <%= car.full_name %>" class="car-image">
                <div class="car-status-badge <%= car.available? ? 'available' : 'unavailable' %>">
                  <%= car.available? ? t('cars.show.available') : t('cars.show.unavailable') %>
                </div>
                <div class="car-year-badge"><%= car.year %></div>
              </div>
              
              <div class="car-details">
                <div class="car-brand"><%= car.brand %></div>
                <h3 class="car-name"><%= car.model %></h3>
                
                <!-- Car Specifications -->
                <div class="car-new-specs w-100">
                  <div class="w-50">
                    <div class="car-new-spec">
                      <span class="car-new-spec-icon">ï¿½</span>
                      <% if car.passengers.present? %>
                        <span><%= car.passengers %> passengers</span>
                      <% end %>
                    </div>

                    <div class="car-new-spec">
                      <span class="car-new-spec-icon">âš™ï¸</span>
                      <% if car.transmission.present? %>
                          <span><%= t("cars.transmission_options.#{car.transmission}", default: car.transmission.titleize) %></span>
                      <% end %>
                    </div>
                  
                    <div class="car-new-spec">
                      <span class="car-new-spec-icon">â›½</span>
                      <% if car.gas.present? %>
                        <span><%= t("cars.gas_options.#{car.gas}", default: car.gas.titleize) %></span>
                      <% end %>
                    </div>
                  </div>
                  
                  <div class="w-50">
                    <div class="car-new-spec">
                      <span class="car-new-spec-icon">ï¿½</span>
                      <% if car.doors.present? %>
                          <span><%= car.doors %> doors</span>
                      <% end %>
                    </div>
                    
                    <div class="car-new-spec">
                      <span class="car-new-spec-icon">ğŸ§³</span>
                      <% if car.trunk_size.present? %>
                          <span><%= car.trunk_size %> trunk</span>
                      <% end %>
                    </div>
                  </div>
                </div>
              </div>
            <% end %>
              
            <div class="car-actions">
              <div class="car-price-display">
                <div class="car-price">â‚¬<%= car.price_per_day %></div>
                <div class="car-price-unit"><%= t('cars.index.price_per_day') %></div>
              </div>

              <div class="car-action-buttons">
                <% if @date_filtered %>
                  <%= link_to t('cars.index.send_inquiry'), new_car_booking_path(car, start_date: @filter_start_date, end_date: @filter_end_date), 
                      class: "btn btn-primary car-book-btn", data: { turbo_frame: "_top" } %>
                <% else %>
                  <%= link_to t('cars.index.send_inquiry'), new_car_booking_path(car), 
                      class: "btn btn-primary car-book-btn", data: { turbo_frame: "_top" } %>
                <% end %>
              </div>
            </div>
          </div>
        <% end %>
      </div>
      
      <div class="view-all-cta">
        <%= link_to t('home.featured_cars.view_all', default: 'ĞŸĞ¾Ğ³Ğ»ĞµĞ´Ğ½Ğ¸ Ğ³Ğ¸ ÑĞ¸Ñ‚Ğµ Ğ²Ğ¾Ğ·Ğ¸Ğ»Ğ°'), cars_path, class: "btn btn-secondary" %>
      </div>
    </div>
  </section>
<% end %>

<!-- Destination Cards Section -->
<section class="destinations-section">
  <div class="container">
    <div class="section-header">
      <h2 class="section-title"><%= t('destinations.section.title') %></h2>
      <p class="section-subtitle"><%= t('destinations.section.subtitle') %></p>
    </div>
    
    <div class="destinations-grid">
      <!-- Ohrid Card -->
      <div class="destination-card">
        <div class="destination-image">
          <img src="https://www.carwiz.mk/data/public/2023-03/sveti-jovan-kaneo-ohrid-rent-a-car-carwiz.jpg" alt="Rent a car Skopje - Autorentals.mk Church of St. John Kaneo overlooking Lake Ohrid crystal clear waters" class="card-image">
          <div class="destination-badge"><%= t('destinations.ohrid.badge') %></div>
        </div>
        <div class="destination-content">
          <h3 class="destination-title"><%= t('destinations.ohrid.title') %></h3>
          <p class="destination-description"><%= t('destinations.ohrid.description') %></p>
          <div class="destination-highlights">
            <span class="highlight">ğŸ›ï¸ <%= t('destinations.ohrid.highlights.historic') %></span>
            <span class="highlight">ğŸŠâ€â™€ï¸ <%= t('destinations.ohrid.highlights.lake') %></span>
            <span class="highlight">ğŸ“¸ <%= t('destinations.ohrid.highlights.scenic') %></span>
          </div>
          <div class="destination-footer">
            <div class="distance-info">
              <span class="distance"><%= t('destinations.ohrid.distance') %></span>
              <span class="drive-time"><%= t('destinations.ohrid.drive_time') %></span>
            </div>
            <%= link_to t('destinations.ohrid.read_more'), ohrid_article_path, class: "btn btn-outline" %>
          </div>
        </div>
      </div>

      <!-- Mavrovo Card -->
      <div class="destination-card">
        <div class="destination-image">
          <img src="https://dynamic-media-cdn.tripadvisor.com/media/photo-o/10/26/88/4c/photo1jpg.jpg?w=1400&h=800&s=1" alt="Rent a car Skopje - Autorentals.mk Mavrovo National Park with pristine mountain lake and snow peaks" class="card-image">
          <div class="destination-badge"><%= t('destinations.mavrovo.badge') %></div>
        </div>
        <div class="destination-content">
          <h3 class="destination-title"><%= t('destinations.mavrovo.title') %></h3>
          <p class="destination-description"><%= t('destinations.mavrovo.description') %></p>
          <div class="destination-highlights">
            <span class="highlight">ğŸ¿ <%= t('destinations.mavrovo.highlights.winter') %></span>
            <span class="highlight">ğŸ¥¾ <%= t('destinations.mavrovo.highlights.hiking') %></span>
            <span class="highlight">ğŸ”ï¸ <%= t('destinations.mavrovo.highlights.mountains') %></span>
          </div>
          <div class="destination-footer">
            <div class="distance-info">
              <span class="distance"><%= t('destinations.mavrovo.distance') %></span>
              <span class="drive-time"><%= t('destinations.mavrovo.drive_time') %></span>
            </div>
            <%= link_to t('destinations.mavrovo.read_more'), mavrovo_article_path, class: "btn btn-outline" %>
          </div>
        </div>
      </div>

      <!-- Matka Card -->
      <div class="destination-card">
        <div class="destination-image">
          <img src="https://dynamic-media-cdn.tripadvisor.com/media/photo-o/16/7c/11/40/matka-canyon.jpg?w=1000&h=-1&s=1" alt="Rent a car Skopje - Autorentals.mk Matka Canyon with emerald waters and limestone cliffs" class="card-image">
          <div class="destination-badge"><%= t('destinations.matka.badge') %></div>
        </div>
        <div class="destination-content">
          <h3 class="destination-title"><%= t('destinations.matka.title') %></h3>
          <p class="destination-description"><%= t('destinations.matka.description') %></p>
          <div class="destination-highlights">
            <span class="highlight">ğŸš£â€â™€ï¸ <%= t('destinations.matka.highlights.kayaking') %></span>
            <span class="highlight">ğŸ•³ï¸ <%= t('destinations.matka.highlights.caves') %></span>
            <span class="highlight">â›ª <%= t('destinations.matka.highlights.monasteries') %></span>
          </div>
          <div class="destination-footer">
            <div class="distance-info">
              <span class="distance"><%= t('destinations.matka.distance') %></span>
              <span class="drive-time"><%= t('destinations.matka.drive_time') %></span>
            </div>
            <%= link_to t('destinations.matka.read_more'), matka_article_path, class: "btn btn-outline" %>
          </div>
        </div>
      </div>
    </div>

    <div class="destinations-cta">
      <h3><%= t('destinations.section.cta_title') %></h3>
      <p><%= t('destinations.section.cta_subtitle') %></p>
      <%= link_to t('destinations.section.browse_cars'), cars_path, class: "btn btn-primary btn-large" %>
    </div>
  </div>
</section>

<!-- FAQ Section -->
<section class="faq-section">
  <div class="container">
    <h2 class="section-title">Rent a Car Skopje FAQs</h2>
    
    <div class="faq-content">
      <div class="faq-item">
        <h3>Do I need an international driving permit to rent a car in Skopje?</h3>
        <p>If your license is not from the EU or UK or not written in Latin characters, many rental car companies in North Macedonia require an international driving permit together with your home license. Even when not strictly required, it is often recommended for tourists.</p>
      </div>

      <div class="faq-item">
        <h3>What documents are required at the rental counter?</h3>
        <p>You normally need a valid driving license, a passport or ID card, and a payment card in the driver's name; in some cases, rental agents may also ask for your flight details or local contact information.</p>
      </div>

      <div class="faq-item">
        <h3>Can I book a one-way rental from Skopje to another city?</h3>
        <p>Yes, one-way rentals are allowed on many routes within North Macedonia, with a one-way fee paid at pickup; international one-way rentals are possible only on certain routes and must be checked in advance.</p>
      </div>

      <div class="faq-item">
        <h3>Is it safe to drive a rental car in Skopje city center?</h3>
        <p>Yes, driving is generally safe if you respect local laws, pay attention to other drivers, and avoid peak rush hours; parking can be limited in central areas, so using hotel or private parking is a smart choice.</p>
      </div>

      <div class="faq-item">
        <h3>What happens if the rental vehicle breaks down?</h3>
        <p>Most serious rental companies in North Macedonia provide 24/7 roadside assistance and, if needed, car replacement within a defined time frame, so you can continue your trip with minimal delay.</p>
      </div>

      <div class="faq-item">
        <h3>Can young drivers rent a car in Skopje?</h3>
        <p>Policies vary, but many rental companies require drivers to be at least 21 and to have held a valid driving license for one or two years; some may charge a young driver fee for renters under a certain age.</p>
      </div>

      <div class="faq-item">
        <h3>Are winter tires and equipment provided when needed?</h3>
        <p>In winter months, rental cars in North Macedonia are commonly equipped with suitable tires and sometimes additional gear as required by local law; confirm this with the rental agent when you finalize your rental plan.</p>
      </div>

      <div class="faq-item">
        <h3>Can I drive my rented car outside North Macedonia?</h3>
        <p>Cross-border travel depends on the rental agreement; some companies allow it with prior notice and extra fees, while others may restrict certain countries, so always ask before you cross any border.</p>
      </div>
    </div>
  </div>
</section>
