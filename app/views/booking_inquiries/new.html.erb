<% content_for :title, "#{t('booking_inquiries.new.title')}#{" - #{@car.full_name}" if @car} - #{t('app.brand')}" %>

<section class="booking-header">
  <div class="container">
    
    <% if @car %>
      <div class="back-nav">
        <%= link_to car_path(@car), class: "back-link" do %>
          <span class="back-icon">‚Üê</span>
          <%= t('booking_inquiries.new.back_to_car') %>
        <% end %>
      </div>
    <% end %>
    
  <h1><%= t('booking_inquiries.new.heading') %></h1>
  <p><%= t('pages.booking_inquiries.new.intro', default: t('booking_inquiries.new.heading')) %></p>
  </div>
</section>

<section class="booking-content">
  <div class="container">
    <div class="booking-layout">
      <!-- Car Summary (if car is selected) -->
      <% if @car %>
        <div class="car-summary-card">
          <div class="car-summary-image">
            <img src="<%= @car.image_url %>" alt="Rent a car Skopje - <%= @car.full_name %>" class="summary-car-image">
          </div>
          <div class="car-summary-details">
            <h3><%= @car.full_name %></h3>
            <div class="summary-price">
              <span class="price-amount">‚Ç¨<%= @car.price_per_day %></span>
              <span class="price-unit"><%= t('booking_inquiries.new.price_per_day') %></span>
            </div>
            <div class="car-features">
              <div class="feature"><%= t('booking_inquiries.new.car_fully_insured') %></div>
              <div class="feature"><%= t('booking_inquiries.new.car_well_maintained') %></div>
              <div class="feature"><%= t('booking_inquiries.new.car_available') %></div>
            </div>
          </div>
        </div>
      <% end %>

      <!-- Inquiry Form -->
      <div class="booking-form-card">
        <% if flash[:alert] %>
          <div class="error-messages">
            <h4>–ì—Ä–µ—à–∫–∞</h4>
            <p><%= flash[:alert] %></p>
          </div>
        <% end %>

        <%= form_with url: @car ? car_booking_inquiries_path(@car) : booking_inquiries_path, class: "booking-form" do |form| %>
          <div class="form-section">
            <h3><%= t('booking_inquiries.new.dates_heading') %></h3>
            <div class="date-inputs">
              <div class="date-group">
                <%= form.label "inquiry[start_date]", t('cars.index.pickup_date'), class: "form-label" %>
                <%= form.date_field "inquiry[start_date]", 
                    class: "form-input border", 
                    min: Date.current,
                    value: @inquiry[:start_date],
                    required: true %>
              </div>
              <div class="date-group">
                <%= form.label "inquiry[end_date]", t('cars.index.dropoff_date'), class: "form-label" %>
                <%= form.date_field "inquiry[end_date]", 
                    class: "form-input border", 
                    min: Date.current + 1.day,
                    value: @inquiry[:end_date],
                    required: true %>
              </div>
            </div>
          </div>

          <div class="form-section">
            <h3><%= t('booking_inquiries.new.location_heading') %></h3>
            <div class="input-group">
              <%= form.label "inquiry[pickup_location]", t('booking_inquiries.new.pickup_location'), class: "form-label" %>
              <%= form.select "inquiry[pickup_location]", 
                  [
                    [t('booking_inquiries.new.choose_location'), ""],
                    [t('booking_inquiries.new.location_option_center'), t('booking_inquiries.new.location_option_center')],
                    [t('booking_inquiries.new.location_option_airport'), t('booking_inquiries.new.location_option_airport')]
                  ],
                  { selected: @inquiry[:pickup_location] }, 
                  { class: "form-input border", required: true } %>
            </div>
          </div>

          <div class="form-section">
            <h3><%= t('booking_inquiries.new.your_info_heading') %></h3>
            <div class="customer-inputs">
              <div class="name-row">
                <div class="input-group">
                  <%= form.label "inquiry[first_name]", t('booking_inquiries.new.first_name'), class: "form-label" %>
                  <%= form.text_field "inquiry[first_name]", class: "form-input border", required: true %>
                </div>
                <div class="input-group">
                  <%= form.label "inquiry[last_name]", t('booking_inquiries.new.last_name'), class: "form-label" %>
                  <%= form.text_field "inquiry[last_name]", class: "form-input border", required: true %>
                </div>
              </div>
              
              <div class="contact-row">
                <div class="input-group">
                  <%= form.label "inquiry[email]", t('booking_inquiries.new.email'), class: "form-label" %>
                  <%= form.email_field "inquiry[email]", class: "form-input border", required: true %>
                </div>
                <div class="input-group">
                  <%= form.label "inquiry[phone]", t('booking_inquiries.new.phone'), class: "form-label" %>
                  <%= form.telephone_field "inquiry[phone]", class: "form-input border", required: true %>
                </div>
              </div>
            </div>
          </div>

          <div class="form-section">
            <h3><%= t('booking_inquiries.new.additional_info_heading') %></h3>
            <div class="input-group">
              <%= form.label "inquiry[message]", t('booking_inquiries.new.message_optional'), class: "form-label" %>
              <%= form.text_area "inquiry[message]", 
                  rows: 4, 
                  placeholder: t('booking_inquiries.new.message_placeholder'), 
                  class: "form-input border" %>
            </div>
          </div>

          <!-- Submit Button -->
          <div class="form-actions">
            <%= form.submit t('booking_inquiries.new.send_request'), 
                class: "btn btn-primary btn-large" %>
            <p class="form-note"><%= t('booking_inquiries.new.note_response') %></p>
          </div>
        <% end %>
      </div>
    </div>
  </div>
</section>

<!-- Information Section -->
<section class="info-section" style="background: var(--bg-secondary); padding: var(--spacing-2xl) 0;">
  <div class="container">
    <div class="info-grid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: var(--spacing-xl);">
      <div class="info-card" style="text-align: center; padding: var(--spacing-xl); background: var(--bg-primary); border-radius: var(--radius-lg);">
        <div style="font-size: 2rem; margin-bottom: var(--spacing-md);">‚ö°</div>
            <h4><%= t('booking_inquiries.new.info_cards.fast_response_title') %></h4>
            <p><%= t('booking_inquiries.new.info_cards.fast_response_body') %></p>
      </div>
      <div class="info-card" style="text-align: center; padding: var(--spacing-xl); background: var(--bg-primary); border-radius: var(--radius-lg);">
        <div style="font-size: 2rem; margin-bottom: var(--spacing-md);">üí∞</div>
            <h4><%= t('booking_inquiries.new.info_cards.best_prices_title') %></h4>
            <p><%= t('booking_inquiries.new.info_cards.best_prices_body') %></p>
      </div>
      <div class="info-card" style="text-align: center; padding: var(--spacing-xl); background: var(--bg-primary); border-radius: var(--radius-lg);">
        <div style="font-size: 2rem; margin-bottom: var(--spacing-md);">üõ°Ô∏è</div>
            <h4><%= t('booking_inquiries.new.info_cards.safety_title') %></h4>
            <p><%= t('booking_inquiries.new.info_cards.safety_body') %></p>
      </div>
    </div>
  </div>
</section>
