<% content_for :title, "–ü–æ—Ç–≤—Ä–¥–∞ –∑–∞ —Ä–µ–∑–µ—Ä–≤–∞—Ü–∏—ò–∞ - AutoRentalsMK" %>

<section class="booking-confirmation-header">
  <div class="container">
    <div class="confirmation-icon">‚úÖ</div>
    <h1>–†–µ–∑–µ—Ä–≤–∞—Ü–∏—ò–∞—Ç–∞ –µ –ø–æ—Ç–≤—Ä–¥–µ–Ω–∞!</h1>
    <p>–í–∞—à–∞—Ç–∞ —Ä–µ–∑–µ—Ä–≤–∞—Ü–∏—ò–∞ –µ —É—Å–ø–µ—à–Ω–æ –∫—Ä–µ–∏—Ä–∞–Ω–∞</p>
    <div class="booking-number">–†–µ–∑–µ—Ä–≤–∞—Ü–∏—ò–∞ #<%= @booking.id %></div>
  </div>
</section>

<section class="booking-details">
  <div class="container">
    <div class="booking-details-layout">
      <!-- Booking Summary -->
      <div class="booking-summary-card">
        <h2>–ü—Ä–µ–≥–ª–µ–¥ –Ω–∞ —Ä–µ–∑–µ—Ä–≤–∞—Ü–∏—ò–∞—Ç–∞</h2>
        
        <div class="booking-info-section">
          <h3>–î–∞—Ç—É–º–∏ –∑–∞ –∏–∑–Ω–∞—ò–º—É–≤–∞—ö–µ</h3>
          <div class="info-row">
            <span class="label">–ü–æ–¥–∏–≥–∞—ö–µ:</span>
            <span class="value"><%= @booking.start_date.strftime("%d %B, %Y") %></span>
          </div>
          <div class="info-row">
            <span class="label">–í—Ä–∞—ú–∞—ö–µ:</span>
            <span class="value"><%= @booking.end_date.strftime("%d %B, %Y") %></span>
          </div>
          <div class="info-row">
            <span class="label">–í—Ä–µ–º–µ—Ç—Ä–∞–µ—ö–µ:</span>
            <span class="value"><%= @booking.duration_in_days %> –¥–µ–Ω<%= @booking.duration_in_days > 1 ? '–∞' : '' %></span>
          </div>
        </div>

        <div class="booking-info-section">
          <h3>–õ–æ–∫–∞—Ü–∏—ò–∞</h3>
          <div class="info-row">
            <span class="label">–ü–æ–¥–∏–≥–∞—ö–µ:</span>
            <span class="value"><%= @booking.pickup_location %></span>
          </div>
          <% if @booking.dropoff_location.present? %>
            <div class="info-row">
              <span class="label">–í—Ä–∞—ú–∞—ö–µ:</span>
              <span class="value"><%= @booking.dropoff_location %></span>
            </div>
          <% end %>
        </div>

        <div class="booking-info-section">
          <h3>–í–æ–∑–∏–ª–æ</h3>
          <div class="vehicle-summary">
            <img src="<%= @booking.car.image_url %>" alt="Rent a car Skopje - <%= @booking.car.full_name %>" class="vehicle-image">
            <div class="vehicle-details">
              <h4><%= @booking.car.full_name %></h4>
              <div class="vehicle-price">‚Ç¨<%= @booking.car.price_per_day %>/–¥–µ–Ω</div>
            </div>
          </div>
        </div>

        <div class="booking-info-section">
          <h3>–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –∑–∞ –∫–ª–∏–µ–Ω—Ç–æ—Ç</h3>
          <div class="info-row">
            <span class="label">–ò–º–µ:</span>
            <span class="value"><%= @booking.customer_name %></span>
          </div>
          <div class="info-row">
            <span class="label">–ï-–ø–æ—à—Ç–∞:</span>
            <span class="value"><%= @booking.customer.email %></span>
          </div>
          <div class="info-row">
            <span class="label">–¢–µ–ª–µ—Ñ–æ–Ω:</span>
            <span class="value"><%= @booking.customer.phone %></span>
          </div>
        </div>

        <% if @booking.special_requests.present? %>
          <div class="booking-info-section">
            <h3>–°–ø–µ—Ü–∏—ò–∞–ª–Ω–∏ –±–∞—Ä–∞—ö–∞</h3>
            <p class="special-requests"><%= @booking.special_requests %></p>
          </div>
        <% end %>

        <div class="price-breakdown">
          <div class="breakdown-row">
            <span>–î–Ω–µ–≤–Ω–∞ —Å—Ç–∞–ø–∫–∞:</span>
            <span>‚Ç¨<%= @booking.car.price_per_day %></span>
          </div>
          <div class="breakdown-row">
            <span>–í—Ä–µ–º–µ—Ç—Ä–∞–µ—ö–µ:</span>
            <span><%= @booking.duration_in_days %> –¥–µ–Ω<%= @booking.duration_in_days > 1 ? '–∞' : '' %></span>
          </div>
          <div class="breakdown-row total">
            <span>–í–∫—É–ø–µ–Ω –∏–∑–Ω–æ—Å:</span>
            <span>‚Ç¨<%= @booking.total_price %></span>
          </div>
        </div>

        <div class="booking-info-section">
          <h3>–ü–ª–∞—ú–∞—ö–µ</h3>
          <div class="info-row">
            <span class="label">–ù–∞—á–∏–Ω –Ω–∞ –ø–ª–∞—ú–∞—ö–µ:</span>
            <span class="value">
              <% if @booking.payment_method == "pay_now" %>
                –û–Ω–ª–∞—ò–Ω –ø–ª–∞—ú–∞—ö–µ (Stripe)
              <% else %>
                –ü–ª–∞—ú–∞—ö–µ –ø—Ä–∏ –ø–æ–¥–∏–≥–∞—ö–µ
              <% end %>
            </span>
          </div>
          <div class="info-row">
            <span class="label">–°—Ç–∞—Ç—É—Å –Ω–∞ –ø–ª–∞—ú–∞—ö–µ—Ç–æ:</span>
            <span class="value">
              <div class="payment-status-badge payment-status-<%= @booking.payment_status %>">
                <% case @booking.payment_status %>
                <% when "payment_paid" %>
                  ‚úÖ –ü–ª–∞—Ç–µ–Ω–æ
                <% when "payment_pending" %>
                  ‚è≥ –í–æ –æ—á–µ–∫—É–≤–∞—ö–µ
                <% when "payment_failed" %>
                  ‚ùå –ù–µ—É—Å–ø–µ—à–Ω–æ
                <% when "payment_cancelled" %>
                  üö´ –û—Ç–∫–∞–∂–∞–Ω–æ
                <% else %>
                  ‚è≥ –í–æ –æ—á–µ–∫—É–≤–∞—ö–µ
                <% end %>
              </div>
            </span>
          </div>
          <% if @booking.stripe_payment_intent_id.present? %>
            <div class="info-row">
              <span class="label">–†–µ—Ñ–µ—Ä–µ–Ω—Ü–∞ –∑–∞ –ø–ª–∞—ú–∞—ö–µ:</span>
              <span class="value payment-reference"><%= @booking.stripe_payment_intent_id %></span>
            </div>
          <% end %>
        </div>

        <div class="booking-status">
          <div class="status-badge status-<%= @booking.status %>">
            <%= @booking.status.humanize %>
          </div>
        </div>
      </div>

      <!-- Next Steps -->
      <div class="next-steps-card">
        <h2>–®—Ç–æ —Å–ª–µ–¥–∏?</h2>
        
        <div class="steps-list">
          <div class="step">
            <div class="step-number">1</div>
            <div class="step-content">
              <h4>–ï-–ø–æ—à—Ç–∞ –∑–∞ –ø–æ—Ç–≤—Ä–¥–∞</h4>
              <p>–ò—Å–ø—Ä–∞—Ç–∏–≤–º–µ –µ-–ø–æ—à—Ç–∞ –∑–∞ –ø–æ—Ç–≤—Ä–¥–∞ –¥–æ <strong><%= @booking.customer.email %></strong> —Å–æ —Å–∏—Ç–µ –¥–µ—Ç–∞–ª–∏.</p>
            </div>
          </div>

          <div class="step">
            <div class="step-number">2</div>
            <div class="step-content">
              <h4>–ü–æ–¥–≥–æ—Ç–≤–µ—Ç–µ –¥–æ–∫—É–º–µ–Ω—Ç–∏</h4>
              <p>–í–µ –º–æ–ª–∏–º–µ –¥–æ–Ω–µ—Å–µ—Ç–µ –≤–∞–∂–µ—á–∫–∞ –≤–æ–∑–∞—á–∫–∞ –¥–æ–∑–≤–æ–ª–∞ –∏ –∫—Ä–µ–¥–∏—Ç–Ω–∞ –∫–∞—Ä—Ç–∏—á–∫–∞ –∑–∞ –ø–æ–¥–∏–≥–∞—ö–µ—Ç–æ.</p>
            </div>
          </div>

          <div class="step">
            <div class="step-number">3</div>
            <div class="step-content">
              <h4>–î–µ–Ω –Ω–∞ –ø–æ–¥–∏–≥–∞—ö–µ</h4>
              <p>–ü—Ä–∏—Å—Ç–∏–≥–Ω–µ—Ç–µ –Ω–∞ –ª–æ–∫–∞—Ü–∏—ò–∞—Ç–∞ –∑–∞ –ø–æ–¥–∏–≥–∞—ö–µ 15 –º–∏–Ω—É—Ç–∏ –ø–æ—Ä–∞–Ω–æ –∑–∞ –Ω–µ–ø—Ä–µ—á–µ–Ω –ø—Ä–æ—Ü–µ—Å.</p>
            </div>
          </div>

          <div class="step">
            <div class="step-number">4</div>
            <div class="step-content">
              <h4>–£–∂–∏–≤–∞—ò—Ç–µ –≤–æ –≤–∞—à–∞—Ç–∞ –≤–æ–∑–±–∞</h4>
              <p>–ò–º–∞—ò—Ç–µ –ø—Ä–µ–∫—Ä–∞—Å–Ω–æ –≤—Ä–µ–º–µ —Å–æ –≤–∞—à–µ—Ç–æ –≤–æ–∑–∏–ª–æ! –ö–æ–Ω—Ç–∞–∫—Ç–∏—Ä–∞—ò—Ç–µ –Ω–µ –≤–æ —Å–µ–∫–æ–µ –≤—Ä–µ–º–µ –∑–∞ –ø–æ–¥–¥—Ä—à–∫–∞.</p>
            </div>
          </div>
        </div>

        <div class="contact-support">
          <h4>–ü–æ—Ç—Ä–µ–±–Ω–∞ –≤–∏ –µ –ø–æ–º–æ—à?</h4>
          <div class="support-options">
            <a href="tel:+38971297645" class="support-btn">
              <span>üìû</span>
              –ü–æ–≤–∏–∫–∞—ò –ø–æ–¥–¥—Ä—à–∫–∞
            </a>
            <a href="mailto:support@autorentalsmk.com" class="support-btn">
              <span>‚úâÔ∏è</span>
              –ò—Å–ø—Ä–∞—Ç–∏ –µ-–ø–æ—à—Ç–∞
            </a>
          </div>
        </div>
      </div>
    </div>

    <!-- Actions -->
    <div class="booking-actions">
      <%= link_to "–ü–æ–≥–ª–µ–¥–Ω–∏ –≥–∏ —Å–∏—Ç–µ —Ä–µ–∑–µ—Ä–≤–∞—Ü–∏–∏", bookings_path, class: "btn btn-secondary" %>
      <%= link_to "–£—Ä–µ–¥–∏ —Ä–µ–∑–µ—Ä–≤–∞—Ü–∏—ò–∞", edit_booking_path(@booking), class: "btn btn-primary" %>
      <%= link_to "–ü—Ä–µ–ª–∏—Å—Ç–∞—ò –ø–æ–≤–µ—ú–µ –≤–æ–∑–∏–ª–∞", cars_path, class: "btn btn-ghost" %>
      <% if @booking.can_be_cancelled? %>
        <%= link_to "–û—Ç–∫–∞–∂–∏ —Ä–µ–∑–µ—Ä–≤–∞—Ü–∏—ò–∞", cancel_booking_path(@booking), 
            method: :patch, 
            class: "btn btn-danger", 
            confirm: "–î–∞–ª–∏ —Å—Ç–µ —Å–∏–≥—É—Ä–Ω–∏ –¥–µ–∫–∞ —Å–∞–∫–∞—Ç–µ –¥–∞ —ò–∞ –æ—Ç–∫–∞–∂–µ—Ç–µ –æ–≤–∞–∞ —Ä–µ–∑–µ—Ä–≤–∞—Ü–∏—ò–∞?" %>
      <% end %>
    </div>
  </div>
</section>
